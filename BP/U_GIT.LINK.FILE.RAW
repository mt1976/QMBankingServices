PROGRAM U_GIT.LINK.FILE.RAW
** INFORMATION ****************************************************************
*   Routine Name : U_GIT.LINK.FILE.RAW
*           Type : PROGRAM
*         Params : 
*            Loc : BP
** AUDIT **********************************************************************
*   Info Updated : 20210411 at 16.25.52 in MWT-QM-DEV by matttownsend
*                : on silicon.local (Mac)
*******************************************************************************

   CRT "EXECUTE - ":DQUOTE(@SENTENCE)

   FN.VOC = "VOC" ; FV.VOC = "" ; ID.VOC = "" ; R.VOC = "" ; STOP.ON.ERROR = @TRUE ; ERROR.TEXT = ""

   OPEN FN.VOC TO FV.VOC ELSE

      ERROR.TEXT = "ERROR   - Unable to Open ":DQUOTE(FN.VOC)

      STOP ERROR.TEXT

   END


   PN.LEN=LEN("U_GIT.LINK.FILE.RAW")+2
   ID.VOC = @SENTENCE[PN.LEN, 999]

   CRT "LINK    - ":DQUOTE(ID.VOC)
   STMT = "CREATE-FILE DICT ":ID.VOC:" DIRECTORY"
   CRT "STMT    - ":DQUOTE(STMT)

   EXECUTE STMT CAPTURING OUTPUT
   CRT "OUTPUT  - ":DQUOTE(OUTPUT)

   READ R.VOC FROM FV.VOC, ID.VOC ELSE
      ERROR.TEXT = "ERROR   - Unable to read ":DQUOTE(ID.VOC)
      STOP ERROR.TEXT
   END
   R.VOC<1> = "F"
   IF R.VOC<2> = "" THEN
      R.VOC<2> = ID.VOC
      CRT "SUCCESS - ":DQUOTE("File DATA link complete")
   END ELSE
      CRT "INFO    - ":DQUOTE("File DATA already linked")
   END
   IF R.VOC<3> = "" THEN
      R.VOC<3> = ID.VOC:".DIC"
      CRT "SUCCESS - ":DQUOTE("File DICT link complete")
   END ELSE
      CRT "INFO    - ":DQUOTE("File DICT already linked")
   END
   WRITE R.VOC TO FV.VOC, ID.VOC
   STOP "DONE    - ":DQUOTE(ID.VOC)
END
