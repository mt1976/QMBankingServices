SUBROUTINE ATMSGBOX2(PRMPT,CAPTION,STYLE,BUTTONS,HELPID,RESPONSE,GUIERRORS,GUISTATE)
************************************************************
*
* Generic AccuTerm GUI MessageBox Subroutine
*
* This subroutine can be called from either GUI or green-screen
* programs. If calling from a GUI program, pass the current
* GUISTATE variable from the GUI environment. Otherwise, pass
* null for the GUISTATE variable.
*
* INPUT:
*  PRMPT      prompt message - for multi-line message, separate lines
*               with SVM
*  CAPTION    caption text
*  STYLE      selects the icon displayed in the message box:
*               0 = no icon, 1 = "X", 2 = "!", 3 = "?", 4 = "i"
*  BUTTONS    selects which buttons are included in message box:
*               0 = OK, 1 = OK/Cancel, 2 = Abort/Retry/Ignore
*               3 = Yes/No/Cancel, 4 = Yes/No, 5 = Retry/Cancel
*               add 100, 200 or 300 to designate that the first,
*               second or third button is the default button
*  HELPID     reserved
*  GUISTATE   null if calling from green-screen program, otherwise pass
*               current GUISTATE from GUI environment
*
* OUTPUT:
*  RESPONSE   indicates which button was clicked: 1 = OK, 2 = Cancel,
*               3 = Abort, 4 = Retry, 5 = Ignore, 6 = Yes, 7 = No
*  GUIERRORS  GUIERRORS<1> is non-zero if errors have occurred
*
$INCLUDE GUIBP ATGUIEQUATES
*
GUIERRORS = ''
RESPONSE = 0
*
* If GUISTATE is not NULL, assume GUI has been initialized
IF GUISTATE EQ '' THEN
 CALL ATGUIINIT2(1.0,'',GUIERRORS,GUISTATE)
 IF GUIERRORS<1> >= 3 THEN RETURN
END
*
CALL ATGUIMSGBOX(PRMPT,CAPTION,STYLE,BUTTONS,HELPID,RESPONSE,GUIERRORS,GUISTATE)
*
* When called from a greeen-screen program, we could call ATGUISHUTDOWN here
* if we wanted, but there's no harm just leaving the GUI environment initialized,
* in case we want to use it again...
*
RETURN
END
