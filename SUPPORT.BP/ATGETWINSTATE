SUBROUTINE ATGETWINSTATE(SESSION.STATE, WINDOW.STATE)
* RETURNS ACCUTERM SESSION & MAIN WINDOW STATE
* 0 = NORMAL, 1 = MINIMIZED, 2 = MAXIMIZED
SCR = 'On Error Resume Next'
SCR = SCR : CHAR(25)
SCR = SCR : 'InitSession.Output CStr(InitSession.WindowState) & Chr$(13)'
SCR = SCR : CHAR(25)
SCR = SCR : 'InitSession.Output Cstr(AccuTerm.WindowState) & Chr$(13)'
PRINT CHAR(27) : CHAR(2) : 'P' : SCR : CHAR(13) :
ECHO OFF
PROMPT ''
INPUT SESSION.STATE
INPUT WINDOW.STATE
ECHO ON
PROMPT '?'
RETURN
END
