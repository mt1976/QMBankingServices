PROGRAM U_LOCAL.TEST
** INFORMATION ****************************************************************
*   Routine Name : U_LOCAL.TEST
*           Type : PROGRAM
*         Params :
*            Loc : UTIL.BP
** AUDIT **********************************************************************
*   Info Updated : 20210203 at 22.55.58 in DEV by root
*                : on mercury.local (Mac)
*******************************************************************************

$INSERT UTIL.BP I_UTIL.H
   CALL U_INITIALISE("U_LOCAL.TEST")
   PID = "U_LOCAL.TEST"
   CRT "START"
   CALL U_START(PID)
   CRT "HEADER"
   CALL U_HEADER("this is a test")
   CRT "OPENFILE"
   FN.FILENAME = "UTIL.CONFIG" ; FV.FILEVAR = ""
   CALL U_IO.OPENFILE(FN.FILENAME, FV.FILEVAR, @FALSE, "")
   CRT "ISSUE READ COMMAND"
   ID.RECORD = "util.properties"
   CALL U_IO.READ.LOCAL(FV.FILEVAR, ID.RECORD, R.RECORD, STOP.ON.ERROR, ERROR.TEXT, "OVERRIDE")
   CRT "BACK FROM READ"
   CALL U_CRT.INFO("ID", ID.RECORD)
   LOCAL.ID.RECORD = UPCASE(SYSTEM(1015)):U_SEP_ALT:ID.RECORD

   NEW.PROPERTIES = COLLECTION()
   NO.PROPERTIES = DCOUNT(R.RECORD, @AM)
   R.RECORD = CHANGE(R.RECORD, U_PROP_SEP, @VM)
   FOR I = 1 TO NO.PROPERTIES

      THIS.PROP = R.RECORD<I, 1>
      THIS.VALU = R.RECORD<I, 2>

      NEW.PROPERTIES{THIS.PROP} = THIS.VALU

   NEXT I

   JS.VERSION = JBUILD(NEW.PROPERTIES)

   CALL U_CRT.INFO("LOCAL", LOCAL.ID.RECORD)
   * CALL U_CRT.INFO("COLLC",NEW.PROPERTIES)
   CALL U_CRT.RECORD(JS.VERSION)
   CALL U_CRT.RECORD(R.RECORD)
   CALL U_STOP(PID)
   STOP "DONE"
END
