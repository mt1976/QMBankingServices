PROGRAM U_CLEARFILES
   PNM = "" ; STOP.ON.ERROR = @TRUE ; ERROR.TEXT = ""
   CALL U_START(PNM)
   CALL U_HEADER("CLEAR FILE(S)")

   FN.UTIL.CONFIG = "UTIL.CONFIG" ; FV.UTIL.CONFIG = ""
   CALL U_OPENFILE(FN.UTIL.CONFIG, FV.UTIL.CONFIG, STOP.ON.ERROR, ERROR.TEXT)

   CMD.STRING = CONVERT(SPACE(1),@AM,@SENTENCE)
   IF CMD.STRING<2> = "" THEN
     CALL U_CRT.ACTION("ERROR","Parameters [ALL, or specific i.e. UTILS/SIENA]")
     CALL U_STOP(PROCESS.NAME)
     STOP
   END

   * remove the program name from the stack of cmds
     DEL CMD.STRING<1>
   * loop through the cmd strings
     NO.CMDS = DCOUNT(CMD.STRING,@AM)

      CALL U_CRT.ACTION("NO PROCESSES",NO.CMDS)
      FOR THIS.CMD = 1 TO NO.CMDS
        DELIVERY.TYPE = CMD.STRING<THIS.CMD>
        CALL U_CRT.ACTION("PROCESS",DELIVERY.TYPE)
        STMT = "SELECT ":FN.UTIL.CONFIG:" LIKE clear.":LOWER(DELIVERY.TYPE):".properties"
        IF DELIVERY.TYPE = "ALL" THEN
          STMT = "SELECT ":FN.UTIL.CONFIG:" LIKE clear.":"...":".properties"
        END
      NEXT THIS.CMD
      CALL U_EXECUTE(STMT,@FALSE)

      PROCESS.LIST = ""
      LOOP
         READNEXT ID.FILE ELSE EXIT
         PROCESS.LIST<-1> = ID.FILE
      REPEAT

      NO.PROPERTIES.FILES = DCOUNT(PROCESS.LIST,@AM)
      CALL U_CRT.ACTION("NO PROPERTIES",NO.PROPERTIES.FILES)

      FOR THIS.PROPERTIES.FILE = 1 TO NO.PROPERTIES.FILES
      CALL U_CRT.ACTION("PROPERTIES",PROCESS.LIST<THIS.PROPERTIES.FILE>)

      CALL U_READ(FV.UTIL.CONFIG, PROCESS.LIST<THIS.PROPERTIES.FILE>, R.UTIL.CONFIG, STOP.ON.ERROR, ERROR.TEXT)
      NO.FILES.TO.CLEAR = DCOUNT(R.UTIL.CONFIG,@AM)
      CALL U_CRT.ACTION("FILES",NO.FILES.TO.CLEAR)
      CALL U_CRT.RECORD(R.UTIL.CONFIG)
      FOR THIS.FILE = 1 TO NO.FILES.TO.CLEAR
          IF R.UTIL.CONFIG<THIS.FILE,1> = "FILE" THEN
      EX.STMT = "CLEAR-FILE DATA ":R.UTIL.CONFIG<THIS.FILE,2>
      CALL U_CRT.ACTION("CLEAR",R.UTIL.CONFIG<THIS.FILE,2>)
      CALL U.CRT.ACTION("STMT",EX.STMT)
      *CALL U_EXECUTE(EX.STMT, VERBOSE)
    NEXT THIS.FILE

      NEXT THIS.PROPERTIES.FILE

   CALL U_STOP(PNM)

   STOP

END
