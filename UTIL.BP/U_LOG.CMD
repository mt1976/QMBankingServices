SUBROUTINE U_LOG.CMD(LOG.DATA, R.UTIL.LOG.EVENT)
** INFORMATION ****************************************************************
* Routine Name   : U_LOG.CMD
*         Type   : SUBROUTINE
*         Params : <<PARAMETERS>>
*         Loc    : UTIL.BP
* -----------------------------------------------------------------------------
* Info Updated   : 20191220 at 15.41.22 in MWT-QM-DEV by sales
*                : on ldn-srv-ubnt01 (Linux)
* -----------------------------------------------------------------------------
*
$INCLUDE UTIL.BP I_UTIL.H
$INCLUDE UTIL.BP F_UTIL.LOG.EVENT.H

   FN.UTIL.LOG.CMD = "UTIL.LOG.CMD" ; FV.UTIL.LOG.CMD = "" ; STOP.ON.ERROR = @TRUE ; ERROR.TEXT = ""
   CALL U_OPENFILE(FN.UTIL.LOG.CMD, FV.UTIL.LOG.CMD, STOP.ON.ERROR, ERROR.TEXT)
   FN.UTIL.LOG.EVENT = "UTIL.LOG.EVENT" ; FV.UTIL.LOG.EVENT = "" ; STOP.ON.ERROR = @TRUE ; ERROR.TEXT = ""
   CALL U_OPENFILE(FN.UTIL.LOG.EVENT, FV.UTIL.LOG.EVENT, STOP.ON.ERROR, ERROR.TEXT)

   ID.UTIL.LOG.CMD = ""
   CALL U_UNIQUE.ID(ID.UTIL.LOG.CMD)

   CALL U_WRITE(FV.UTIL.LOG.CMD, ID.UTIL.LOG.CMD, LOG.DATA, STOP.ON.ERROR, ERROR.TEXT)

   IF R.UTIL.LOG.EVENT<U_LOG_EVENT> = "" THEN R.UTIL.LOG.EVENT<U_LOG_EVENT> = "UNKOWN"
   R.UTIL.LOG.EVENT<U_LOG_DATE> = OCONV(DATE(), "DX")
   R.UTIL.LOG.EVENT<U_LOG_TIME> = OCONV(TIME(), "MTS.")
   R.UTIL.LOG.EVENT<U_LOG_USER> = @USER
   R.UTIL.LOG.EVENT<U_LOG_ID> = ID.UTIL.LOG.CMD
   R.UTIL.LOG.EVENT<U_LOG_TTY> = @TTY
   R.UTIL.LOG.EVENT<U_LOG_USERNO> = @USERNO
   R.UTIL.LOG.EVENT<U_LOG_PATH> = @PATH
   R.UTIL.LOG.EVENT<U_LOG_WHO> = @WHO
   R.UTIL.LOG.EVENT<U_LOG_SENTENCE> = @SENTENCE
   R.UTIL.LOG.EVENT<U_LOG_IP> = @IP.ADDR
   R.UTIL.LOG.EVENT<U_LOG_HOST> = SYSTEM(1015)
   R.UTIL.LOG.EVENT<U_LOG_PLATFORM> = SYSTEM(1010)
   R.UTIL.LOG.EVENT<U_LOG_PROCESS>  = SYSTEM(33)

   CALL U_WRITE(FV.UTIL.LOG.EVENT, ID.UTIL.LOG.CMD, R.UTIL.LOG.EVENT, STOP.ON.ERROR, ERROR.TEXT)

   RETURN
END
