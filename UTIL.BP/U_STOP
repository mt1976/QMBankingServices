SUBROUTINE U_STOP(PROGRAM.NAME)
   STMT = "COMO OFF"
   HUSH ON
   EXECUTE STMT
   HUSH OFF
   CALL U_CRT.ACTION("COMO OFF",PROGRAM.NAME)
   IF PROGRAM.NAME <> "" THEN
      FN.COMO = "$COMO" ; FV.COMO = "" ; STOP.ON.ERROR = @TRUE
      CALL U_OPENFILE(FN.COMO, FV.COMO, @TRUE, "")

      FN.UTIL.LOG = "UTIL.LOG" ; FV.UTIL.LOG = ""
      CALL U_OPENFILE(FN.UTIL.LOG, FV.UTIL.LOG, STOP.ON.ERROR, "")
      R.RECORD = ""
      CALL U_READ(FV.COMO, PROGRAM.NAME, R.RECORD, STOP.ON.ERROR, ERROR.TEXT)
      OUTPUT.NAME = PROGRAM.NAME:".log"
      CALL U_WRITE(FV.UTIL.LOG, OUTPUT.NAME, R.RECORD, STOP.ON.ERROR, ERROR.TEXT)
      CALL U_DELETE(FV.COMO, PROGRAM.NAME, STOP.ON.ERROR, ERROR.TEXT)
   END
   RETURN
END
