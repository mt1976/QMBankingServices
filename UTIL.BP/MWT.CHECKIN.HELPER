SUBROUTINE MWT.CHECKIN(FN.CHECKIN, ID.CHECKIN)

   IF FN.CHECKIN # '' AND ID.CHECKIN # '' THEN

   FN.TXFR= "UTIL.TRANSFER" ; FV.VOC = "" ; ID.VOC = ""
   CALL M.OPENFILE(FN.TXFR, FV.TXFR, @TRUE, "")

   FN.BACKUP= "UTIL.BACKUP" ; FV.VOC = "" ; ID.VOC = ""
   CALL M.OPENFILE(FN.BACKUP, FV.BACKUP, @TRUE, "")

      IF ID.CHECKIN = "*" THEN
         STMT = "SELECT ":FN.CHECKIN
         CALL M.EXECUTE(STMT, @TRUE)

         LOOP
            READNEXT ID.PROCESS ELSE EXIT
            ID.CHECKIN = ID.PROCESS
            GOSUB CHECK.IN
         REPEAT

      END ELSE
         GOSUB CHECK.IN
      END
   END

RETURN

CHECK.IN:
   FV.CHECKIN=""
   CALL M.OPENFILE(FN.CHECKIN, FV.CHECKIN, @TRUE, "")
   ID.TXFR = FN.CHECKIN:"~":ID.CHECKIN

   STMT = "DELETE ":FN.TXFR:" ":DQUOTE(ID.TXFR)
   CALL M.EXECUTE(STMT, @TRUE)

   STMT = "COPY FROM ":FN.CHECKIN:" TO ":FN.TXFR:" ":DQUOTE(ID.CHECKIN):",":DQUOTE(ID.TXFR)
   CALL M.EXECUTE(STMT, @TRUE)

   ID.BACKUP = ID.TXFR:"~":@YEAR4:@MONTH:@DAY
   STMT = "COPY FROM ":FN.CHECKIN:" TO ":FN.BACKUP:" ":DQUOTE(ID.CHECKIN):",":DQUOTE(ID.BACKUP)
   CALL M.EXECUTE(STMT, @FALSE)

   RETURN

END
