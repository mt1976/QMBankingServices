PROGRAM SIENA.DELIVER
$INCLUDE UTIL.BP UTIL.H

   PROCESS.NAME = ""
   CALL U_START(PROCESS.NAME)

   CALL U_HEADER("SIENA.DO")

   CMD.STRING = CONVERT(SPACE(1), @AM, @SENTENCE)
   IF CMD.STRING<2> = "" THEN
      CALL U_CRT.ACTION("ERROR", "Parameters [A specific type i.e. RVMARKET]")
      CALL U_STOP(PROCESS.NAME)
      STOP
   END
* remove the program name from the stack of cmds
   DEL CMD.STRING<1>
* loop through the cmd strings
   THIS.CMD = 1

   DO.ITEM = CMD.STRING<THIS.CMD>
   CALL U_CRT.ACTION("PROCESS", DO.ITEM)

   DO.SCRIPT = ""
   DO.PROCESSOR = ""
   DO.DELIVER = ""

   CALL U_GET.PROPERTY("SIENA.CONFIG", "siena", DO.ITEM, DO.DATA)

   DO.DATA = CONVERT(U_SEP, @AM, DO.DATA)

   DO.SCRIPT = DO.DATA<1>
   DO.PROCESSOR = DO.DATA<2>
   DO.DELIVER = DO.DATA<3>

   IF DO.SCRIPT <> "" THEN
      CALL U_CRT.ACTION("DO SCRIPT", DO.SCRIPT)
      CALL SIENA.SCRIPT.HELPER(DO.SCRIPT)
      CALL U_CRT.ACTION("DO DONE", DO.SCRIPT)
   END
   IF DO.PROCESSOR <> "" THEN
      SUB.NAME = "SIENA.":DO.PROCESSOR:".HELPER"
      DO.SUBN = SUB.NAME
      CALL U_CRT.ACTION("DO SUB", DO.SUBN)
      CALL @SUB.NAME(SUB.NAME)
      CALL U_CRT.ACTION("DO DONE", DO.SUBN)
   END
   IF DO.DELIVER <> "" THEN
      CALL U_CRT.ACTION("DO DELIVER", DO.DELIVER)
      CALL SIENA.DELIVER.HELPER(SUB.NAME, DO.DELIVER)
      CALL U_CRT.ACTION("DO DONE", DO.DELIVER)
   END

   CALL U_STOP(PROCESS.NAME)

END
